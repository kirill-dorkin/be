# Детальное описание компонентов проекта

## Архитектурные слои

### 1. Презентационный слой (UI Components)

#### Основные компоненты интерфейса

**AvatarMenu.tsx**
- Назначение: Выпадающее меню профиля пользователя
- Функции: Отображение аватара, меню настроек, выход из системы
- Интеграция: Использует NextAuth для управления сессией

**BaseContainer.tsx**
- Назначение: Базовый контейнер для обертки контента
- Функции: Адаптивная разметка, центрирование контента
- Использование: Основа для всех страниц

**ClientHeader.tsx**
- Назначение: Клиентский заголовок с навигацией
- Функции: Навигация, переключение языков, корзина, избранное
- Особенности: Адаптивный дизайн, поддержка мобильных устройств

**Footer.tsx**
- Назначение: Подвал сайта с дополнительной информацией
- Функции: Ссылки, контакты, социальные сети

#### Компоненты форм

**InputFormField.tsx**
- Назначение: Универсальное поле ввода для форм
- Функции: Валидация, обработка ошибок, различные типы ввода
- Интеграция: React Hook Form, Zod валидация

**PhoneInputField.tsx**
- Назначение: Специализированное поле для ввода телефона
- Функции: Форматирование номера, международные коды

**RequestForm.tsx**
- Назначение: Форма для отправки запросов
- Функции: Сбор данных клиента, отправка на сервер

#### E-commerce компоненты

**CartDropdown.tsx**
- Назначение: Выпадающее меню корзины покупок
- Функции: Просмотр товаров, изменение количества, переход к оформлению
- Состояние: Синхронизация с глобальным состоянием корзины

**CartIcon.tsx**
- Назначение: Иконка корзины с индикатором количества
- Функции: Отображение количества товаров, анимации

**FavoritesDropdown.tsx**
- Назначение: Выпадающее меню избранных товаров
- Функции: Быстрый доступ к избранному, удаление из списка

**FavoritesSheet.tsx**
- Назначение: Боковая панель с полным списком избранного
- Функции: Детальный просмотр, управление списком

#### Утилитарные компоненты

**LanguageSwitcher.tsx**
- Назначение: Переключатель языков интерфейса
- Функции: Смена локали, сохранение предпочтений
- Поддержка: ru, en, kg

**LoadingScreen.tsx**
- Назначение: Экран загрузки приложения
- Функции: Индикация загрузки, плавные переходы

**LazyComponents.tsx**
- Назначение: Ленивая загрузка компонентов
- Функции: Оптимизация производительности, code splitting

### 2. Специализированные модули

#### /components/admin/
**Назначение**: Компоненты административной панели
- Управление пользователями
- Управление товарами и категориями
- Аналитика и отчеты
- Настройки системы

#### /components/analytics/
**Назначение**: Компоненты системы аналитики
- Дашборды с метриками
- Графики продаж
- Анализ поведения пользователей
- Отчеты по производительности

#### /components/charts/
**Назначение**: Компоненты графиков и диаграмм
- Интерактивные графики
- Визуализация данных
- Экспорт отчетов

#### /components/dashboard/
**Назначение**: Компоненты панели управления
- Виджеты статистики
- Быстрые действия
- Уведомления
- Навигация по разделам

#### /components/home/
**Назначение**: Компоненты главной страницы
- Слайдеры и баннеры
- Рекомендуемые товары
- Категории товаров
- Промо-блоки

#### /components/shop/
**Назначение**: Компоненты интернет-магазина
- Каталог товаров
- Фильтры и сортировка
- Карточки товаров
- Процесс оформления заказа

#### /components/pwa/
**Назначение**: PWA компоненты
- Установка приложения
- Офлайн уведомления
- Push-уведомления

#### /components/ui/
**Назначение**: Базовые UI компоненты (shadcn/ui)
- Кнопки, инпуты, модальные окна
- Навигация, аккордеоны
- Типографика, иконки

### 3. Слой бизнес-логики

#### Хуки (Hooks)

**useCart.ts**
- Назначение: Управление состоянием корзины
- Функции: Добавление/удаление товаров, расчет суммы
- Персистентность: LocalStorage, синхронизация с сервером

**useFavorites.ts**
- Назначение: Управление избранными товарами
- Функции: Добавление в избранное, синхронизация

**useAnalytics.ts**
- Назначение: Сбор и отправка аналитических данных
- Функции: Трекинг событий, метрики производительности

**usePWA.ts**
- Назначение: PWA функциональность
- Функции: Установка приложения, обновления, офлайн режим

**useLocalStorage.ts**
- Назначение: Работа с локальным хранилищем
- Функции: Сохранение настроек, кэширование данных

#### Обработчики (Handlers)

**taskHandlers.ts**
- Назначение: Обработка задач и процессов
- Функции: CRUD операции с задачами
- Интеграция: MongoDB, валидация данных

**userHandlers.ts**
- Назначение: Обработка пользовательских данных
- Функции: Регистрация, профиль, права доступа

### 4. Слой данных

#### Модели (Models)

**User.ts**
- Поля: email, password, role, profile
- Связи: Orders, Cart, Favorites
- Валидация: Email уникальность, пароль сложность

**Product.ts**
- Поля: name, description, price, images, category
- Связи: Category, Cart, Orders
- Индексы: По категории, цене, популярности

**Cart.ts**
- Поля: userId, products, totalAmount
- Связи: User, Product
- Логика: Автоматический расчет суммы

**Order.ts**
- Поля: userId, products, status, totalAmount
- Связи: User, Product
- Статусы: pending, processing, shipped, delivered

**Category.ts**
- Поля: name, description, parentId
- Структура: Иерархическая (дерево категорий)

#### Сервисы (Services)

**analyticsApi.ts**
- Назначение: API для аналитических данных
- Функции: Сбор метрик, генерация отчетов

**taskService.ts**
- Назначение: Сервис управления задачами
- Функции: Планирование, выполнение, мониторинг

### 5. Слой конфигурации

#### Аутентификация

**auth.ts (NextAuth)**
- Провайдеры: Credentials, Google, GitHub
- Сессии: JWT токены, база данных
- Middleware: Защита маршрутов

#### Интернационализация

**i18n.ts**
- Локали: ru, en, kg
- Переводы: Динамическая загрузка
- Форматирование: Даты, числа, валюты

#### База данных

**dbConnect.ts**
- Подключение: MongoDB с пулом соединений
- Оптимизация: Кэширование, индексы

**redis/cache.ts**
- Кэширование: Сессии, часто запрашиваемые данные
- TTL: Настраиваемое время жизни

### 6. API слой

#### Структура API маршрутов

**/api/auth/**
- Аутентификация и авторизация
- Регистрация, вход, выход
- Восстановление пароля

**/api/products/**
- CRUD операции с товарами
- Поиск и фильтрация
- Управление изображениями

**/api/cart/**
- Управление корзиной
- Синхронизация между устройствами

**/api/orders/**
- Оформление заказов
- Отслеживание статуса
- История покупок

**/api/admin/**
- Административные функции
- Управление пользователями
- Системная аналитика

### 7. Утилиты и вспомогательные функции

#### /lib/utils.ts
- Общие утилиты
- Форматирование данных
- Валидация

#### /lib/dbUtils.ts
- Утилиты для работы с БД
- Оптимизированные запросы
- Агрегация данных

#### Схемы валидации

**DeviceSchema.ts**
- Валидация данных устройств
- Zod схемы для типобезопасности

**ServiceSchema.ts**
- Валидация сервисных данных

**TaskSchema.ts**
- Валидация задач и процессов

## Взаимодействие компонентов

### Поток данных
1. **UI компоненты** → **Хуки** → **Сервисы** → **API** → **База данных**
2. **Middleware** проверяет аутентификацию и локализацию
3. **Кэш (Redis)** ускоряет часто запрашиваемые данные
4. **PWA** обеспечивает офлайн функциональность

### Состояние приложения
- **Глобальное состояние**: React Context + Providers
- **Локальное состояние**: React useState/useReducer
- **Серверное состояние**: SWR/React Query паттерны
- **Персистентное состояние**: LocalStorage + Database

### Безопасность
- **Аутентификация**: NextAuth.js с JWT
- **Авторизация**: Role-based access control
- **Валидация**: Zod схемы на клиенте и сервере
- **Санитизация**: Очистка пользовательского ввода

### Производительность
- **Code Splitting**: Динамические импорты
- **Lazy Loading**: Компоненты и изображения
- **Кэширование**: Redis + Browser cache
- **Оптимизация изображений**: Next.js Image component

## Паттерны разработки

1. **Compound Components** - Сложные UI компоненты
2. **Custom Hooks** - Переиспользуемая логика
3. **Provider Pattern** - Управление состоянием
4. **Repository Pattern** - Абстракция доступа к данным
5. **Factory Pattern** - Создание объектов
6. **Observer Pattern** - Реактивные обновления

Эта архитектура обеспечивает масштабируемость, поддерживаемость и высокую производительность приложения.
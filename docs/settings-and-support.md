# Настройки, персонал и поддержка

Это руководство покрывает раздел **Configuration** панели Saleor: каналы, налоги, доставку, сотрудников и базовые проверки безопасности.

## 1. Каналы продаж (Channels)
- Откройте **Configuration → Channels**.
- Каждый канал — это отдельная витрина или регион. По умолчанию настроены `default-channel` и `repair-services`.
- В карточке канала можно:
  - Включить/выключить публикацию.
  - Задать валюту и язык по умолчанию.
  - Указать склады (Warehouses) и способы доставки.
- После изменения не забудьте нажать **Save** и уведомить коллег.

## 2. Налоги и доставка
### 2.1 Налоги (Tax settings)
- **Configuration → Taxes**.
- Для фиксированных ставок выберите **Manual rates** и заполните таблицу.
- Если используется внешняя система (например, Avalara), укажите API-ключи и включите интеграцию.

### 2.2 Доставка (Shipping)
1. Перейдите в **Configuration → Shipping**.
2. Создайте метод доставки (**Create shipping method**).
3. Заполните название, описание, каналы и зоны доставки.
4. Добавьте стоимость (фиксированная или зависящая от веса/цены).
5. Сохраните и протестируйте, оформив тестовый заказ.

## 3. Способы оплаты
- Конфигурация выполняется через приложение Stripe (см. [apps/stripe/README.md](https://github.com/kirill-dorkin/be/blob/main/apps/stripe/README.md)).
- В панели Saleor откройте **Configuration → Payments** и убедитесь, что приложение активировано для нужных каналов.
- При проблемах откройте Stripe Dashboard и проверьте webhook-уведомления.

## 4. Сотрудники и права доступа
1. **Configuration → Staff Members**.
2. Нажмите **Add staff member**.
3. Укажите email, выберите «Send email with activation link» или задайте пароль.
4. Назначьте группы прав:
   - **Sales Managers** — доступ к заказам и клиентам.
   - **Catalog Managers** — управление товарами.
   - **Repair Workers** — сотрудники сервисного центра (см. [docs/repair-services.md](https://github.com/kirill-dorkin/be/blob/main/docs/repair-services.md)).
5. Сохраните. Новый сотрудник получит письмо.

### 4.1 Создание новой группы прав
1. **Configuration → Permission Groups → Create group**.
2. Укажите название (например, «Support Team»).
3. Отметьте нужные разрешения (Orders, Products, Users и т.д.).
4. Добавьте сотрудников в группу.

## 5. Уведомления и коммуникации
- **Configuration → Emails** — настройка шаблонов писем (логотип, контакты поддержки).
- **Configuration → Webhooks** — интеграции с внешними сервисами (например, Slack, CRM). Проверьте URL и секретные ключи.
- **Configuration → Apps** — список подключённых приложений. Здесь же можно установить новые (например, интеграции доставки).

## 6. Безопасность
- Периодически меняйте пароли сотрудников и удаляйте неактивные аккаунты.
- Проверяйте, что у ключевых ролей включена двухфакторная аутентификация (если доступна).
- Ведите журнал действий: раздел **Activity** в карточке сотрудника показывает последние действия.

## 7. Когда обращаться в поддержку
| Проблема | Куда обратиться |
| --- | --- |
| Ошибки в оплате, отклонённые транзакции | Поддержка Stripe + внутренний DevOps. |
| Не создаются заказы или черновики | Команда разработчиков, приложите скриншоты и логи. |
| Неверные цены или налоги | Catalog Manager + бухгалтерия. |
| Нет доступа к разделу | Администратор Saleor (проверьте группы прав). |

## 8. Контрольный список администратора
- [ ] Проведена ежемесячная ревизия прав доступа.
- [ ] Проверены логи вебхуков (нет ошибок 4xx/5xx).
- [ ] Обновлены ключи интеграций (Stripe, ButterCMS, Algolia) при необходимости.
- [ ] Уточнены контактные данные поддержки в письмах.

Если вопрос не решается самостоятельно, создайте тикет с подробным описанием, приложите ссылки на заказы/товары и укажите канал (Production или Staging).
